<div [@fadeInOut] (click)="active = false" class="overlay" *ngIf="active"></div>

<div class="navbar-pricing__cell" [class.active]="active">
  <div class="navbar-pricing__cell_body" (click)="active = !active">
    <div class="navbar-pricing__upper">{{symbols[0]}} / {{symbols[1]}}</div>
    <div class="navbar-pricing__lower">Select Market Pair</div>
  </div>

  <div [@fadeInOut] class="pair-container" *ngIf="active">
    <header>
      <form (ngSubmit)="onSubmit()" id="pairForm" #pairForm="ngForm" novalidate>
        <div class="row d-md-none">
          <p class="type2">SELECT MARKET PAIR</p>
        </div>
        <div class="form-group row">
          <div class="col-6 col-md-4">
            <div class="input-group">
              <input name="coinA" type="text"
              required placeholder="Select first coin"
              tabindex="1" autocomplete="off"
              validCoin
              (focus)="activeInputKey = 'coinA'"
              (keyup.ArrowDown)="onArrowDown($event)"
              #coinA="ngModel" #input
              [ngModel]="formatRow(model.coinA)"
              (ngModelChange)="filterCoins('coinA', $event)">
            </div>
          </div>
          <div class="col-6 col-md-4">
            <div class="input-group">
              <input name="coinB" type="text"
              required placeholder="second coin"
              tabindex="2" autocomplete="off"
              validCoin
              (focus)="activeInputKey = 'coinB'"
              (keyup.ArrowDown)="onArrowDown($event)"
              [disabled]="!coinA.valid"
              #coinB="ngModel" #input
              [ngModel]="formatRow(model.coinB)"
              (ngModelChange)="filterCoins('coinB', $event)">
            </div>
          </div>
          <div class="col-md-4 d-none d-md-block">
            <button #submit tabindex="0" type="submit" [disabled]="!pairForm.form.valid">Select</button>
          </div>
        </div>
      </form>
    </header>

    <app-table
      #pairTable
      [rows]="filteredRows"
      [selectable]="true"
      (onRowSelect)="onRowSelect($event)">

      <app-table-column [prop]="'symbol'" [classList]="'col-2 align-left'">
        <ng-template columnHeader>Coin</ng-template>
        <ng-template let-row="row" columnCell>
          <span class="coin-cell">
            <span *ngIf="model.coinA && coinA.valid">{{model.coinA.symbol}}/</span>{{row.symbol}}
          </span>
        </ng-template>
      </app-table-column>

      <app-table-column [prop]="'name'" [classList]="'col-2 align-left d-none d-md-block'">
        <ng-template columnHeader>Currency</ng-template>
        <ng-template let-row="row" columnCell>
          <span class="capitalize">{{row.name}}</span>
        </ng-template>
      </app-table-column>

      <app-table-column [prop]="'last'" [classList]="'col-5 col-md-3'">
        <ng-template columnHeader>Last Price</ng-template>
        <ng-template let-row="row" columnCell>
          <span>{{row.last}}</span>
        </ng-template>
      </app-table-column>

      <app-table-column [prop]="'volume'" [classList]="'col-3 d-none d-md-block'">
        <ng-template columnHeader>Volume</ng-template>
        <ng-template let-row="row" columnCell>
          <span>{{row.volume}}</span>
        </ng-template>
      </app-table-column>

      <app-table-column [prop]="'change'" [classList]="'col-5 col-md-2'">
        <ng-template columnHeader>% Change</ng-template>
        <ng-template let-row="row" columnCell>
          <span>{{row.change | percent:'1.2-2'}}</span>
        </ng-template>
      </app-table-column>

    </app-table>

    <div class="submit-button" *isBp="['xs', 'sm']" [style.display]="pairForm.form.valid ? 'block' : 'none'">
      <button tabindex="-1" type="submit" form="pairForm">Select</button>
    </div>

  </div>
</div>
